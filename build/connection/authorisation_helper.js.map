{"version":3,"file":"authorisation_helper.js","sourceRoot":"","sources":["../../src/connection/authorisation_helper.ts"],"names":["AuthorisationHelper","AuthorisationHelper.constructor","AuthorisationHelper.authorizeAsClient","AuthorisationHelper.authorizeAsServer","AuthorisationHelper.generateToken","AuthorisationHelper.handleExpectedHandshakeResponse","AuthorisationHelper.handleExpectedHandshake","AuthorisationHelper.checkToken","AuthorisationHelper.writeToParser"],"mappings":"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"}